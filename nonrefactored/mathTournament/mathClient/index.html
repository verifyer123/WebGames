<html>
<meta charset="utf-8" />
<meta http-equiv="cache-control" content="max-age=0" />
<meta http-equiv="cache-control" content="no-cache" />
<meta http-equiv="expires" content="-1" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
<meta http-equiv="pragma" content="no-cache" />
<head>
    <title>Yogome Minigame</title>

    <!--Style sheets-->
    <link rel="stylesheet" type="text/css" href="../../shared/minigames/css/custom_fonts.css">
    <link rel="stylesheet" type="text/css" href="../../shared/minigames/css/minigame.css">
    <link rel="stylesheet" type="text/css" href="css/index.css">
    <link rel="stylesheet" type="text/css" href="css/custom_fonts.css">
    <script  src="js/jquery-3.1.1.min.js"></script>
</head>
<body>
    <div id="logoMath"><img src="images/logoMath.png"/></div>
<div id="orientation-overlay" style="visibility: hidden"></div>
<div class="custom-font">
    <p>Created at Yogome, inc.</p>
    <p>www.yogome.com</p>
</div>

<script>
var localizationData = {
		"EN":{
            "pin":"Write PIN",
            "Nickname": "Nickname",
            "start":"Start Game",
            "player":"Player",
            "ready":"Ready!",
            "waiting":"Waiting your Oponent"
		},

		"ES":{
            "pin":"Escribe el PIN",
            "Nickname": "Apodo",
            "start":"Empezar",            
            "player":"Jugador",
            "ready":"Â¡Listo!",
            "waiting":"Esperando a tu oponente"
        }
        };
        var language = "EN"
        if(parent.window.location.search){
            var params = parent.window.location.search.trim(1)
            var regex = /language=(..)/i
            var result = regex.exec(params)
            
            if(result){
                language = result[result.index].toUpperCase()    
            }else{
                language = "EN"
            }
            
        } 
    var selectYogotarName;
	var onClientInit = function(e){
		$("#settings").append('<div id ="readyPlayerStroke">' + localizationData[language].player + " " +  cliente.numPlayer + " " + localizationData[language].ready +'</div><div id ="readyPlayer">' + localizationData[language].player + " " +  1 + " " + localizationData[language].ready +'</div><div id="waitOponent">' + localizationData[language].waiting + '<div class="loading"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></div></div>');
//		var div_resultado = document.getElementById("resultado");
//		var btn_start = document.getElementById("start");
//        var dataInfo =  document.getElementById("dataInfo");
//        $("#settings").append('<div id ="readyPlayerStroke">' + localizationData[language].player + " " +  cliente.numPlayer + " " + localizationData[language].ready +'</div><div id ="readyPlayer">' + localizationData[language].player + " " +  1 + " " + localizationData[language].ready +'</div><div id="waitOponent">' + localizationData[language].waiting + '<div class="loading"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></div></div>');
//		//div_resultado.innerText = "Player: "+cliente.numPlayer + "Ready!";
//        $("#infoContainer").css("height",'0');
//        $("#infoContainer").css("visibility",'hidden');
//        //dataInfo.style.visibility = 'hidden';
//		//btn_start.style.visibility = 'hidden';
//        $("#start").hide();
//        $("#arrowRight").hide();
//        $("#arrowLeft").hide();
//        $("input").prop("disabled",true);
//
//		if(cliente.numPlayer!= null){
//			document.getElementById("start").disabled =true;
//		}
	}

	function onPlayersReady(event) {
		cliente.removeEventListener('onClientInit', onClientInit);
		cliente.removeEventListener('onGameFull', onGameFull);
		cliente.removeEventListener('showPossibleAnswers', onPlayersReady);
//		window.open("http://yogome.com/epic/minigames/mathClient/operations.html", "_self")
		window.open("../mathClient/operations.html", "_self")
	}

	var onGameFull = function(){
		alert("La partida ya se encuentra ocupada");
	}

	cliente = parent.cliente;
	function startButton(){
        if($("#idGame").val() != "" && $("#nickname").val() != ""){
            var idGame = cliente.id_game || document.getElementById("idGame").value;
            var player = {
                nickname: document.getElementById("nickname").value,
                avatar: selectYogotarName,
                life: 100,
                ready:false
            }
            cliente.addEventListener('onClientInit', onClientInit);
            cliente.addEventListener('onGameFull', onGameFull);
            cliente.startGame = onPlayersReady
            cliente.start(player, idGame);
			var div_resultado = document.getElementById("resultado");
			var btn_start = document.getElementById("start");
			var dataInfo =  document.getElementById("dataInfo");
			//div_resultado.innerText = "Player: "+cliente.numPlayer + "Ready!";
			$("#infoContainer").css("height",'0');
			$("#infoContainer").css("visibility",'hidden');
			//dataInfo.style.visibility = 'hidden';
			//btn_start.style.visibility = 'hidden';
			$("#start").hide();
			$("#arrowRight").hide();
			$("#arrowLeft").hide();
			$("input").prop("disabled",true);

			if(cliente.numPlayer!= null){
				document.getElementById("start").disabled =true;
			}
        }

	}
</script>
    <div id="MenuYogotar">
        <div id="arrowLeft" class="arrow-menu"><img src="images/arrow_left.png"/></div>
        <div id="arrowRight" class="arrow-menu"><img src="images/arrow_right.png"/></div>
    </div>
<div id="settings">
    <!--<select id="avatar">
        <option value="1" selected >Eagle</option>
        <option value="2">Luna</option>
    </select> -->   
    <section id="nameYogo"></section>
        <section id="avatar">
            
        </section>
    <section id="infoContainer">
        <section id="dataInfo">
        <div id="pin">
            <p class="text0">Write PIN</p>
            <input id="idGame" type="text" placeholder="PIN" />
        </div>
        <p class="text1">Nickname</p>
        <input type="text" id="nickname" placeholder="Player"/>
        </section>    
        <hr>
        <input type="button" id="start" onclick="startButton()" style="box-shadow: 0px 1vh 0px #1b3473;"/>
        <div id="resultado"></div>
    </section>
</div>
</body>
    <script>
   
    
    $(".text0").text(localizationData[language].pin);  
    $(".text1").text(localizationData[language].Nickname);  
    $("#start").attr("value",localizationData[language].start);          
        
		if((cliente)&&(cliente.id_game)){
			var pinSection = document.getElementById("pin");
			pinSection.style.display = 'none';
			$("#idGame").val(cliente.id_game)
		}

		var yogotarCharacters = [
            {
                index:0,
                name:"eagle",
                nameText:"Eagle",
                img:"images/eagle.png"
            },
            {   
                index:1,
                name:"luna",
                nameText:"Luna",
                img:"images/luna.png"
            },
        ];
        
                $("#nameYogo").append('<div id="nameYogotarStroke">'+yogotarCharacters[0].nameText +'</div><div id="nameYogotar">'+yogotarCharacters[0].nameText +'</div>');
            for(var i = 0;i<=yogotarCharacters.length-1;i++){
                $("#avatar").append('<div id="SelectYogotar'+yogotarCharacters[i].index+'" class="yogotarBlock"><img src="'+yogotarCharacters[i].img+'" /></div>');
                $("#SelectYogotar" + +yogotarCharacters[i].index).css("opacity",1-(i*1));
            }
                
           selectYogotarName = yogotarCharacters[0].name;
            var lengthAvatar = $("#avatar").find("div").length;
            var YogoPosx = parseInt($("#SelectYogotar1").css("left"));
            var counter = 0;
//            console.log(YogoPosx);
        
            $("#arrowRight").click(function(){ 
                $(this).css("padding-right","28%");  
                $(this).animate({'padding-right':"30%"}, 50, 'linear');  
                if(counter != lengthAvatar-1){   
                    
       
                    counter++;
                    
                $("#SelectYogotar" + +yogotarCharacters[counter-1].index).css("opacity",0);
                $("#SelectYogotar" + +yogotarCharacters[counter-1].index).css("left",0);  
                $("#nameYogotar").text(yogotarCharacters[counter].nameText); 
                $("#nameYogotarStroke").text(yogotarCharacters[counter].nameText);
                $("#SelectYogotar" + +yogotarCharacters[counter].index).css("left","50%");     
                $("#SelectYogotar" + +yogotarCharacters[counter].index).css("opacity",1);     
                $("#SelectYogotar" + +yogotarCharacters[counter].index).css("height","80%");  
                $("#SelectYogotar" + +yogotarCharacters[counter].index ).animate({height: "100%"}, 50, 'linear');    
                }
                selectYogotarName = yogotarCharacters[counter].name;
        });
      
        $("#arrowLeft").click(function(){
                $(this).css("padding-left","28%");  
                $(this).animate({'padding-left':"30%"}, 50, 'linear'); 
             if(counter != 0){   
                    counter--;
                $("#SelectYogotar" + +yogotarCharacters[counter+1].index).css("opacity",0);
                $("#SelectYogotar" + +yogotarCharacters[counter+1].index).css("left",0);  
                $("#nameYogotar").text(yogotarCharacters[counter].nameText); 
                $("#nameYogotarStroke").text(yogotarCharacters[counter].nameText); 
                $("#SelectYogotar" + +yogotarCharacters[counter].index).css("left","50%");     
                $("#SelectYogotar" + +yogotarCharacters[counter].index).css("opacity",1); 
                $("#SelectYogotar" + +yogotarCharacters[counter].index).css("height","80%");  
                $("#SelectYogotar" + +yogotarCharacters[counter].index ).animate({height: "100%"}, 50, 'linear');                    
                }
                selectYogotarName = yogotarCharacters[counter].name;
        });
                
        
        $("input[type='text']").on('input',function(e){
                          if($("#idGame").val() != "" && $("#nickname").val() != ""){
                         $("#start").css("opacity",1);
                     }else{
                         $("#start").css("opacity",0.5);
                     }
                });
        
        
    </script>
    
</html>
